(function(i,l){typeof exports=="object"&&typeof module<"u"?l(exports,require("@tanstack/vue-query"),require("vue")):typeof define=="function"&&define.amd?define(["exports","@tanstack/vue-query","vue"],l):(i=typeof globalThis<"u"?globalThis:i||self,l(i.VueQueryRequestUtils={},i.VueQuery,i.Vue))})(this,(function(i,l,s){"use strict";const j=Symbol("api");function $(){const t=s.inject(j);if(t)return t}function S(t){return{install(e){e.provide(j,t)}}}const a=t=>typeof t=="string"||typeof t=="number"||typeof t=="boolean";class A extends Error{constructor(e){super(`[useGet] ${e}`),this.name="UseGetError"}}const d=t=>{const e=s.toValue(t);if(Array.isArray(e))return e.map(d);if(e&&typeof e=="object"&&!Array.isArray(e)){const n={};for(const r in e)n[r]=d(e[r]);return n}return e},g=(t,e="paramRef")=>{if(t!=null&&!a(t)){if(Array.isArray(t)){t.forEach((n,r)=>{if(!a(n))throw new A(`[${e}[${r}]] must be string | number | boolean, got ${typeof n}`)});return}if(typeof t=="object"){if("path"in t||"query"in t){if(t.path&&(!Array.isArray(t.path)||!t.path.every(a)))throw new A(`[${e}.path] must be an array of string | number | boolean`);if(t.query&&(typeof t.query!="object"||Array.isArray(t.query)))throw new A(`[${e}.query] must be a plain object`);if(t.query){for(const[n,r]of Object.entries(t.query))if(!a(r)&&!(Array.isArray(r)&&r.every(a)))throw new A(`[${e}.query.${n}] must be string | number | boolean or array of those`)}return}for(const[n,r]of Object.entries(t))if(!a(r)&&!(Array.isArray(r)&&r.every(a)))throw new A(`[${e}.${n}] must be string | number | boolean or array of those`);return}throw new A(`[${e}] Unsupported type: ${typeof t}`)}},k=(t,e)=>{let n=[],r={};a(e)?n=[String(e)]:Array.isArray(e)?n=e.map(String):e&&typeof e=="object"&&("path"in e||"query"in e?(Array.isArray(e.path)&&(n=e.path.map(String)),e.query&&typeof e.query=="object"&&!Array.isArray(e.query)&&(r=e.query)):r=e);const u=n.length>0?`${n.join("/")}`:"",h=Object.keys(r).length>0?`?${new URLSearchParams(Object.entries(r).flatMap(([y,p])=>Array.isArray(p)?p.map(c=>[y,String(p)]):[[y,String(p)]])).toString()}`:"";return`${t}${u}${h}`};function P({url:t,queryKey:e,API:n,options:r,paramRef:u}){if(!t||typeof t!="string")throw new Error("Invalid or missing URL");const h=s.isRef(u)?u:s.ref(u),y=s.computed(()=>{const f=s.toValue(e),o=d(h),b=Array.isArray(f)?f.map(d):[d(f)];return o&&(typeof o=="object"&&!Array.isArray(o)&&("path"in o||"query"in o)?b.push(o.path??[],o.query??{}):b.push(o)),b}),p=$(),c=n??p;if(!c)throw new Error("No API instance provided, please provide an api instance via the API prop or use the provideApi function.");return l.useQuery({queryKey:y.value,queryFn:async()=>{const f=d(s.unref(h));g(f);const o=f?k(t,f):t;return(await c.get(o)).data},...r})}function U({API:t,method:e,url:n,paramsRef:r,requestConfig:u,options:h,mutationKey:y}){const p=$(),c=t??p,f=s.computed(()=>y?Array.isArray(y)?y:[y]:void 0);if(!c)throw new Error("No API instance provided, please provide an api instance via the API prop or use the provideApi function.");const o=e.toLowerCase(),b=s.isRef(r)?r:s.ref(r);return l.useMutation({mutationKey:f.value,mutationFn:async()=>{let w;const v=d(s.unref(b));g(v);const q=v??{};switch(o){case"post":w=await c.post(n,q,u);break;case"put":w=await c.put(n,q,u);break;case"patch":w=await c.patch(n,q,u);break;case"delete":w=await c.delete(n,{...u,data:q});break;default:throw new Error(`HTTP method not supported: ${e}`)}return w.data},...h})}i.provideApi=S,i.useApi=$,i.useGet=P,i.useSend=U,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})}));
